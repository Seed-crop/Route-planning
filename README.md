# Route-planning

## 动态激光除草路径规划系统 (Dynamic Laser Weeding Path Planning System)

### 项目简介

该项目实现了一个动态激光除草路径规划系统的仿真。系统模拟安装在移动平台上的激光除草系统，包括：

- **双激光振镜系统**：左右各一个激光振镜，每个有固定的矩形工作区域
- **动力学约束**：振镜受限于最大角速度和角加速度
- **时间窗口约束**：由于平台移动，杂草只在有限时间窗口内可被处理
- **Slack时间硬约束**：确保处理完成后有足够的安全余量
- **多种路径规划算法**：支持贪心、最近邻、先进先出、动态规划等算法

### 系统特点

1. **硬约束Slack时间**：每个杂草处理完成后必须保证至少有设定的slack时间才会离开工作区
2. **多算法比较**：实现了4种不同的路径规划算法，可对比性能
3. **可视化输出**：生成直观的路径规划图和性能对比图
4. **参数化配置**：所有系统参数都可配置

### 安装依赖

```bash
pip install -r requirements.txt
```

### 运行仿真

```bash
python laser_weeding_planning.py
```

### 输出结果

运行后会生成以下文件：

1. **路径规划可视化图**：
   - `planning_greedy.png` - 贪心算法规划结果
   - `planning_nearest_neighbor.png` - 最近邻算法规划结果
   - `planning_fifo.png` - 先进先出算法规划结果
   - `planning_dynamic_programming.png` - 动态规划算法结果

2. **性能对比图**：
   - `algorithm_comparison.png` - 各算法成功率对比
   - `slack_time_impact.png` - slack时间对成功率的影响

### 算法说明

#### 1. 贪心算法 (Greedy)
总是选择剩余时间最少的杂草进行处理，在满足slack时间约束的前提下最大化处理数量。

#### 2. 最近邻算法 (Nearest Neighbor)
选择距离当前位置最近的杂草，减少振镜移动时间。

#### 3. 先进先出 (FIFO)
按照检测顺序处理杂草，简单直接。

#### 4. 动态规划 (Dynamic Programming)
对于小规模问题（≤15个杂草），使用动态规划找到最优解。

### 系统参数

默认配置参数：

```python
platform_velocity = 50.0  # mm/s - 平台速度
laser_treatment_time = 0.1  # s - 单个杂草处理时间
slack_time = 0.05  # s - Slack时间硬约束
max_angular_velocity = 5.0  # rad/s - 最大角速度
max_angular_acceleration = 50.0  # rad/s^2 - 最大角加速度
focal_length = 500.0  # mm - 焦距
```

工作区设置：
- 左振镜工作区：X(-200, 0) mm, Y(0, 200) mm
- 右振镜工作区：X(0, 200) mm, Y(0, 200) mm

### 核心功能

1. **振镜动力学模型**：
   - 考虑角速度和角加速度约束
   - 使用梯形速度规划计算移动时间

2. **时间窗口计算**：
   - 根据平台速度和工作区范围计算每个杂草的可处理时间窗口
   - 确保激光到达、处理、离开都在时间窗口内

3. **Slack时间约束**：
   - 作为硬约束实施
   - 必须满足：离开时间 - 处理完成时间 ≥ slack_time

4. **路径规划**：
   - 为左右振镜独立规划路径
   - 考虑所有约束条件
   - 最大化处理成功率

### 扩展性

代码结构清晰，易于扩展：
- 可添加新的路径规划算法
- 可调整系统参数
- 可修改振镜工作区配置
- 可集成实际的杂草检测数据

### 许可证

MIT License

